
<!-- Page Header with gradient background -->
<section class="pt-6 pb-10 md:pt-10 md:pb-14 px-4 md:px-6 lg:px-8 relative overflow-hidden" style="background: linear-gradient(180deg, #FDF8F5 0%, #F0F9F7 50%, #FDF2F2 100%);">
  <!-- Decorative floating elements -->
  <div class="absolute top-10 right-10 w-20 h-20 rounded-full blur-2xl floating-icon" style="background: rgba(242, 194, 194, 0.4);"></div>
  <div class="absolute top-40 left-10 w-16 h-16 rounded-full blur-2xl floating-icon" style="background: rgba(193, 221, 216, 0.4); animation-delay: 1s;"></div>
  <div class="absolute bottom-10 right-1/4 w-24 h-24 rounded-full blur-2xl floating-icon" style="background: rgba(192, 223, 208, 0.3); animation-delay: 2s;"></div>

  <div class="max-w-6xl mx-auto text-center relative z-10">
    <h1 class="font-heading font-bold text-4xl md:text-5xl lg:text-6xl text-gray-800 mb-4">
      Special <span style="color: #C1DDD8;">Milestones</span>
    </h1>
    <p class="font-body text-gray-600 max-w-2xl mx-auto text-lg">
      Những khoảnh khắc kỳ diệu đánh dấu hành trình trưởng thành của Nacon
    </p>
  </div>
</section>

<!-- Stats Summary -->
<section class="py-8 px-4 md:px-6 lg:px-8 -mt-6">
  <div class="max-w-4xl mx-auto">
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
      <!-- Total Milestones -->
      <div class="stat-card glass-card rounded-2xl p-5 text-center shadow-xl cursor-pointer">
        <div class="w-14 h-14 rounded-2xl flex items-center justify-center mx-auto mb-3 shadow-lg gradient-animated">
          <p class="font-body text-sm text-gray-500">Tổng cột mốc</p>
        </div>
        <p class="stat-number font-heading font-bold text-3xl text-gray-800"><%= @achieved.count + @pending.count %></p>
      </div>

      <!-- Achieved -->
      <div class="stat-card glass-card rounded-2xl p-5 text-center shadow-xl cursor-pointer">
        <div class="w-14 h-14 rounded-2xl flex items-center justify-center mx-auto mb-3 shadow-lg" style="background: linear-gradient(135deg, #F2C2C2 0%, #E8B0B0 100%);">
          <p class="font-body text-sm text-gray-500">Đã đạt được</p>
        </div>
        <p class="stat-number font-heading font-bold text-3xl text-gray-800"><%= @achieved.count %></p>
      </div>

      <!-- Coming Soon -->
      <div class="stat-card glass-card rounded-2xl p-5 text-center shadow-xl cursor-pointer">
        <div class="w-14 h-14 rounded-2xl flex items-center justify-center mx-auto mb-3 shadow-lg" style="background: linear-gradient(135deg, #C0DFD0 0%, #A8D1BD 100%);">
          <p class="font-body text-sm text-gray-500">Sắp tới</p>
        </div>
        <p class="stat-number font-heading font-bold text-3xl text-gray-800"><%= @pending.count %></p>
      </div>

      <!-- Baby Age -->
      <div class="stat-card glass-card rounded-2xl p-5 text-center shadow-xl cursor-pointer">
        <div class="w-14 h-14 rounded-2xl flex items-center justify-center mx-auto mb-3 shadow-lg" style="background: linear-gradient(135deg, #A8CEC8 0%, #C1DDD8 100%);">
          <p class="font-body text-sm text-gray-500">Tháng tuổi</p>
        </div>
        <p class="stat-number font-heading font-bold text-3xl text-gray-800">15</p>
      </div>
    </div>
  </div>
</section>

<!-- Achieved Milestones -->
<section class="py-12 px-4 md:px-6 lg:px-8" style="background: linear-gradient(180deg, #F8FAF9 0%, #FDF8F5 100%);">
  <div class="max-w-6xl mx-auto">
    <div class="flex items-center gap-3 mb-8">
      <div class="w-12 h-12 rounded-2xl flex items-center justify-center shadow-lg" style="background: linear-gradient(135deg, #10B981, #059669);">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-white">
          <path fill-rule="evenodd" d="M8.603 3.799A4.49 4.49 0 0112 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 013.498 1.307 4.491 4.491 0 011.307 3.497A4.49 4.49 0 0121.75 12a4.49 4.49 0 01-1.549 3.397 4.491 4.491 0 01-1.307 3.497 4.491 4.491 0 01-3.497 1.307A4.49 4.49 0 0112 21.75a4.49 4.49 0 01-3.397-1.549 4.49 4.49 0 01-3.498-1.306 4.491 4.491 0 01-1.307-3.498A4.49 4.49 0 012.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 011.307-3.497 4.49 4.49 0 013.497-1.307zm7.007 6.387a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" />
        </svg>
      </div>
      <div>
        <h2 class="font-heading font-bold text-2xl text-gray-800">Đã đạt được</h2>
        <p class="font-body text-sm text-gray-500"><%= @achieved.count %> cột mốc hoàn thành</p>
      </div>
    </div>

    <% if @achieved.any? %>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <% @achieved.each_with_index do |milestone, index| %>
          <% gradients = [
            ['#FFE4E6', '#FDF2F2', '#F2C2C2'],
            ['#D1FAE5', '#F0FDF9', '#10B981'],
            ['#E0F2FE', '#F0F9FF', '#0EA5E9'],
            ['#FEF3C7', '#FFFBEB', '#F59E0B'],
            ['#F3E8FF', '#FAF5FF', '#A855F7'],
            ['#FCE7F3', '#FDF2F8', '#EC4899']
          ] %>
          <% gradient = gradients[index % gradients.length] %>

          <div class="milestone-card bg-white rounded-3xl shadow-xl cursor-pointer" style="border-radius: 1.5rem;">
            <!-- Image Area -->
            <div class="relative aspect-[4/3] overflow-hidden rounded-t-3xl" style="background: linear-gradient(135deg, <%= gradient[0] %> 0%, <%= gradient[1] %> 100%); border-radius: 1.5rem 1.5rem 0 0;">
              <% if milestone.image_path.present? || milestone.photo.attached? %>
                <% if milestone.image_path.present? %>
                  <%= image_tag milestone.image_path, class: "milestone-image w-full h-full object-cover", alt: milestone.name %>
                <% elsif milestone.photo.attached? %>
                  <%= image_tag milestone.photo.variant(resize_to_fill: [600, 450, { quality: 90 }]), class: "milestone-image w-full h-full object-cover", alt: milestone.name %>
                <% end %>
              <% else %>
                <div class="w-full h-full flex items-center justify-center">
                  <div class="text-center">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" class="w-16 h-16 mx-auto mb-2" style="color: <%= gradient[2] %>40;">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z" />
                      <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z" />
                    </svg>
                    <p class="font-body text-sm" style="color: <%= gradient[2] %>80;">Chưa có ảnh</p>
                  </div>
                </div>
              <% end %>

              <!-- Achieved Badge - TOP RIGHT -->
              <div class="absolute top-4 right-4">
                <span class="px-3 py-1.5 font-heading font-bold text-xs rounded-full shadow-lg flex items-center gap-1.5" style="background: linear-gradient(135deg, #10B981 0%, #059669 100%); color: #FFFFFF;">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4">
                    <path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" />
                  </svg>
                  Hoàn thành
                </span>
              </div>
            </div>

            <!-- Content -->
            <div class="px-5 py-4 rounded-b-3xl" style="border-radius: 0 0 1.5rem 1.5rem;">
              <div class="flex gap-3">
                <!-- Icon column -->
                <div class="flex-shrink-0">
                  <div class="w-7 h-7 rounded-full flex items-center justify-center" style="background: <%= gradient[0] %>;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-3.5 h-3.5" style="color: <%= gradient[2] %>;">
                      <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
                    </svg>
                  </div>
                </div>
                <!-- Text column -->
                <div class="flex-1 min-w-0">
                  <span class="font-heading font-bold text-sm block mb-1.5 italic" style="color: <%= gradient[2] %>;"><%= milestone.achieved_at&.strftime("%d/%m/%Y") || "N/A" %></span>
                  <h3 class="font-heading font-bold text-lg text-gray-800 mb-1 italic line-clamp-1"><%= milestone.name %></h3>
                  <p class="font-body text-xs text-gray-500 line-clamp-2 italic leading-relaxed"><%= milestone.description || "Một cột mốc đặc biệt trong hành trình lớn lên." %></p>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="text-center py-16 bg-white rounded-3xl border shadow-lg">
        <div class="w-24 h-24 rounded-full mx-auto mb-6 flex items-center justify-center" style="background: linear-gradient(135deg, #D1FAE5, #10B981);">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12 text-white">
            <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
          </svg>
        </div>
        <h3 class="font-heading font-bold text-2xl text-gray-700 mb-2">Chưa có milestone nào</h3>
        <p class="font-body text-gray-500">Những bước tiến của bé sẽ được ghi lại ở đây.</p>
      </div>
    <% end %>
  </div>
</section>

<!-- Coming Soon Milestones -->
<% if @pending.any? %>
  <section class="py-12 px-4 md:px-6 lg:px-8 bg-white">
    <div class="max-w-6xl mx-auto">
      <div class="flex items-center gap-3 mb-8">
        <div class="w-12 h-12 rounded-2xl flex items-center justify-center shadow-lg" style="background: linear-gradient(135deg, #F2C2C2, #E8B0B0);">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-white">
            <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zM12.75 6a.75.75 0 00-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 000-1.5h-3.75V6z" clip-rule="evenodd" />
          </svg>
        </div>
        <div>
          <h2 class="font-heading font-bold text-2xl text-gray-800">Sắp tới</h2>
          <p class="font-body text-sm text-gray-500"><%= @pending.count %> cột mốc đang chờ</p>
        </div>
      </div>

      <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4">
        <% pending_colors = [
          ['#FDF2F8', '#EC4899'],
          ['#EFF6FF', '#3B82F6'],
          ['#F0FDF4', '#22C55E'],
          ['#FEF3C7', '#F59E0B'],
          ['#FAF5FF', '#A855F7'],
          ['#FFF7ED', '#F97316'],
          ['#F0F9FF', '#0EA5E9'],
          ['#FDF4FF', '#D946EF']
        ] %>
        <% @pending.each_with_index do |milestone, index| %>
          <% colors = pending_colors[index % pending_colors.length] %>
          <div class="pending-card rounded-2xl p-5 border-2 border-dashed cursor-pointer" style="background: <%= colors[0] %>; border-color: <%= colors[1] %>30;">
            <div class="w-12 h-12 rounded-xl flex items-center justify-center mx-auto mb-4" style="background: <%= colors[1] %>20;">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6" style="color: <%= colors[1] %>;">
                <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
              </svg>
            </div>
            <h3 class="font-heading font-semibold text-base text-gray-700 text-center mb-1"><%= milestone.name %></h3>
            <p class="font-body text-xs text-center" style="color: <%= colors[1] %>;">Đang chờ đợi...</p>
          </div>
        <% end %>
      </div>
    </div>
  </section>
<% end %>

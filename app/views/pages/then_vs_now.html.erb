<% content_for :og_tags do %>
  <meta property="og:title" content="Then vs Now - NaChiNaCon">
  <meta property="og:description" content="So sÃ¡nh áº£nh trÆ°á»›c vÃ  bÃ¢y giá» cá»§a bÃ© Nacon">
<% end %>

<section class="min-h-screen py-12 px-4 md:px-6 lg:px-8 relative overflow-hidden" style="background: linear-gradient(180deg, #FFFBF8 0%, #F8FDFC 50%, #FDF5F5 100%);">
  <!-- Background decorations -->
  <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <div class="absolute top-20 -right-20 w-72 h-72 rounded-full blur-3xl pulse-glow" style="background: rgba(242, 194, 194, 0.25);"></div>
    <div class="absolute bottom-20 -left-20 w-64 h-64 rounded-full blur-3xl pulse-glow" style="background: rgba(193, 221, 216, 0.25); animation-delay: 2s;"></div>
  </div>

  <div class="max-w-5xl mx-auto relative z-10">
    <!-- Top Navigation -->
    <%= render 'shared/game-nav', title: 'Then vs Now', icon: 'ðŸ”„' %>

    <!-- Age Group Selectors -->
    <div class="flex flex-col sm:flex-row gap-4 justify-center mb-10">
      <div class="flex items-center gap-3">
        <span class="font-heading font-semibold text-sm text-gray-600">Truoc:</span>
        <div class="flex gap-2 flex-wrap">
          <% @age_groups.each do |label, value| %>
            <%= link_to label, then_vs_now_path(before: value, after: @selected_after),
                class: "px-4 py-2 rounded-xl font-heading font-semibold text-sm transition-all duration-300 #{value == @selected_before ? 'text-white shadow-lg' : 'text-gray-600 hover:shadow-md'}",
                style: value == @selected_before ? "background: linear-gradient(135deg, #F2C2C2, #E8B0B0);" : "background: rgba(242, 194, 194, 0.15);" %>
          <% end %>
        </div>
      </div>
      <div class="flex items-center gap-3">
        <span class="font-heading font-semibold text-sm text-gray-600">Sau:</span>
        <div class="flex gap-2 flex-wrap">
          <% @age_groups.each do |label, value| %>
            <%= link_to label, then_vs_now_path(before: @selected_before, after: value),
                class: "px-4 py-2 rounded-xl font-heading font-semibold text-sm transition-all duration-300 #{value == @selected_after ? 'text-white shadow-lg' : 'text-gray-600 hover:shadow-md'}",
                style: value == @selected_after ? "background: linear-gradient(135deg, #C1DDD8, #A8CEC8);" : "background: rgba(193, 221, 216, 0.15);" %>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Comparison -->
    <% if @before_memory && @after_memory %>
      <div class="max-w-2xl mx-auto">
        <!-- Side by side photos -->
        <div class="grid grid-cols-2 gap-3 md:gap-4">
          <!-- Before -->
          <div class="glass-card rounded-2xl overflow-hidden shadow-lg">
            <div style="position:relative;">
              <div style="aspect-ratio:3/4;overflow:hidden;background:#f3f4f6;">
                <%= image_tag @before_memory.image_path, style: "width:100%;height:100%;object-fit:cover;", alt: @before_memory.title %>
              </div>
              <div style="position:absolute;top:8px;left:8px;padding:4px 10px;border-radius:8px;background:rgba(242,194,194,0.9);">
                <span class="font-heading font-bold text-white" style="font-size:11px;">Truoc</span>
              </div>
            </div>
            <div class="p-3 text-center">
              <p class="font-heading font-bold text-gray-800 text-sm truncate"><%= @before_memory.title %></p>
              <p class="font-body text-xs text-gray-500"><%= @before_memory.taken_at.strftime('%d/%m/%Y') %></p>
            </div>
          </div>

          <!-- After -->
          <div class="glass-card rounded-2xl overflow-hidden shadow-lg">
            <div style="position:relative;">
              <div style="aspect-ratio:3/4;overflow:hidden;background:#f3f4f6;">
                <%= image_tag @after_memory.image_path, style: "width:100%;height:100%;object-fit:cover;", alt: @after_memory.title %>
              </div>
              <div style="position:absolute;top:8px;right:8px;padding:4px 10px;border-radius:8px;background:rgba(193,221,216,0.9);">
                <span class="font-heading font-bold text-white" style="font-size:11px;">Sau</span>
              </div>
            </div>
            <div class="p-3 text-center">
              <p class="font-heading font-bold text-gray-800 text-sm truncate"><%= @after_memory.title %></p>
              <p class="font-body text-xs text-gray-500"><%= @after_memory.taken_at.strftime('%d/%m/%Y') %></p>
            </div>
          </div>
        </div>

        <!-- Shuffle Button -->
        <div class="text-center mt-6">
          <%= link_to then_vs_now_path(before: @selected_before, after: @selected_after, t: Time.now.to_i),
              class: "inline-flex items-center gap-2 px-6 py-3 rounded-xl font-heading font-semibold text-white shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105",
              style: "background: linear-gradient(135deg, #C1DDD8, #A8CEC8);" do %>
            <span>ðŸ”€</span>
            <span>Xem cáº·p khÃ¡c</span>
          <% end %>
        </div>
      </div>
    <% else %>
      <div class="text-center py-16 glass-card rounded-3xl shadow-xl max-w-lg mx-auto">
        <div class="text-6xl mb-4">ðŸ“·</div>
        <h3 class="font-heading font-bold text-xl text-gray-700 mb-2">ChÆ°a Ä‘á»§ áº£nh Ä‘á»ƒ so sÃ¡nh</h3>
        <p class="font-body text-gray-500">Cáº§n cÃ³ áº£nh á»Ÿ cáº£ hai giai Ä‘oáº¡n tuá»•i Ä‘á»ƒ sá»­ dá»¥ng tÃ­nh nÄƒng nÃ y.</p>
      </div>
    <% end %>

  </div>
</section>
